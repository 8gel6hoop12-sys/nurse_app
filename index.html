<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>看護アシスタント | 入口</title>
<style>
:root{--bg:#fff7fb;--panel:#fff;--line:#ead0dc;--accent:#f59bc0;--text:#2e2a2f}
*{box-sizing:border-box}html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"Hiragino Kaku Gothic ProN","Noto Sans JP","Yu Gothic UI",sans-serif}
.wrap{max-width:1100px;margin:28px auto;padding:20px}
.card{background:var(--panel);border:1px solid var(--line);border-radius:16px;padding:24px}
h1{font-size:46px;margin:6px 0 14px}
.lead{font-size:20px;line-height:1.9;margin:8px 0 22px}
.btn{display:inline-flex;align-items:center;gap:10px;background:var(--accent);color:#fff;border:0;border-radius:14px;padding:16px 24px;font-weight:800;font-size:22px;cursor:pointer}
.btn:hover{filter:brightness(.98)}
.badge{display:inline-block;padding:4px 10px;border-radius:999px;font-size:12px;margin-left:8px}
.badge.ok{background:#e6f6ec;color:#1b7a3f}
.badge.ng{background:#ffe2e6;color:#8f1d28}
.small{color:#6b5a64;font-size:14px}
hr{border:none;border-top:1px dashed var(--line);margin:18px 0}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1 id="title">いつもお疲れさまです</h1>
    <p id="msg" class="lead">
      今日も安全と安心のために尽くしてくださって、ありがとうございます。<br>
      ここでは、ふだんの流れのまま、入力と確認をすっと終わらせるお手伝いをします。<br>
      記録や画像は端末内だけで完結します。外へは出しません。
    </p>

    <button id="btnStart" class="btn">▶ はじめる</button>
    <span id="stat" class="badge ng">接続NG</span>

    <hr>
    <div class="small" id="hint">［はじめる］を押すと接続確認 → 問題なければアプリ画面を開きます。</div>
  </div>
</div>

<script>
const STAT = document.getElementById('stat');
function setOK(ok){ STAT.textContent = ok?'接続OK':'接続NG'; STAT.className = 'badge ' + (ok?'ok':'ng'); }

// 毎回ちょっと違う “ねぎらい” を表示（AI不要・軽量）
(function(){
  const lines = [
    "夜勤も日勤も、本当にお疲れさまです。あなたの気づきが、患者さんの安心につながっています。",
    "忙しい中でも丁寧なケアをありがとうございます。少しでも手間を減らせるよう整えました。",
    "体調は大丈夫ですか？無理しすぎず、休める時はしっかり休んでくださいね。作業はここでサッと終わらせましょう。"
  ];
  const n = Math.floor(Math.random() * lines.length);
  document.getElementById('msg').innerHTML =
    lines[n] + "<br>記録や画像は端末内だけで完結します。外へは出しません。";
})();

// 接続確認（自動遷移しない）
async function ping(){
  try{
    await fetch('http://127.0.0.1:8787/ai/health',{mode:'no-cors',cache:'no-store'});
    setOK(true); return true;
  }catch(e){ setOK(false); return false; }
}

// 「はじめる」を押したらだけ遷移
document.getElementById('btnStart').addEventListener('click', async ()=>{
  const ok = await ping();
  if(ok){ location.href = 'http://127.0.0.1:8787/nurse_ui.html'; }
  else { alert('アプリが起動していません。\n配布側にお知らせください。'); }
});

// 画面表示時に軽く接続状態だけ見る（遷移はしない）
(async ()=>{ for(let i=0;i<2;i++){ await ping(); await new Promise(r=>setTimeout(r,400)); } })();
</script>
</body>
</html>
